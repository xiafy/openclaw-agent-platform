# éƒ¨ç½²è‡ªåŠ¨åŒ–ä½¿ç”¨æŒ‡å—

> **ç‰ˆæœ¬**: v1.0
> **æ—¥æœŸ**: 2026-02-27
> **ç”¨é€”**: Agent è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·ä½¿ç”¨æŒ‡å—

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### L1 éƒ¨ç½² (Profile æ¨¡å¼ï¼Œ5 min)

```bash
# äº¤äº’å¼éƒ¨ç½²
cd ~/Documents/claw-outputs/projects/agent-platform
./deploy/bin/deploy-agent --mode l1 --name researcher --role "å•†ä¸šç ”ç©¶å‘˜"

# å…¨è‡ªåŠ¨éƒ¨ç½²
./deploy/bin/deploy-agent --mode l1 --name researcher \
  --role "å•†ä¸šç ”ç©¶å‘˜" \
  --bot-token "123456:ABCdef..." \
  --no-verify
```

### L2 éƒ¨ç½² (ç‹¬ç«‹ç”¨æˆ·ï¼Œ30 min)

```bash
# äº¤äº’å¼éƒ¨ç½²
./deploy/bin/deploy-agent --mode l2 --username wifey --role "å¤«äººåŠ©ç†"

# å…¨è‡ªåŠ¨éƒ¨ç½²
./deploy/bin/deploy-agent --mode l2 --username wifey \
  --role "å¤«äººåŠ©ç†" \
  --bot-token "123456:ABCdef..." \
  --no-verify
```

---

## ğŸ“– å‘½ä»¤å‚è€ƒ

### ä¸»å‘½ä»¤

```bash
./deploy/bin/deploy-agent [é€‰é¡¹]
```

### é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ | å¿…éœ€ |
|------|------|------|
| `--mode l1/l2` | éƒ¨ç½²æ¨¡å¼ | âœ… |
| `--name <åç§°>` | Agent åç§° (L1) | L1 å¿…éœ€ |
| `--username <ç”¨æˆ·å>` | macOS ç”¨æˆ·å (L2) | L2 å¿…éœ€ |
| `--role <æè¿°>` | è§’è‰²æè¿° | æ¨è |
| `--bot-token <Token>` | Telegram Bot Token | å¯é€‰ |
| `--port <ç«¯å£>` | æŒ‡å®šç«¯å£ | å¯é€‰ |
| `--uid <UID>` | æŒ‡å®š UID (L2) | å¯é€‰ |
| `--dry-run` | é¢„æ¼”æ¨¡å¼ | - |
| `--no-verify` | è·³è¿‡éªŒè¯ | - |
| `--verbose, -v` | è¯¦ç»†è¾“å‡º | - |
| `--list` | åˆ—å‡ºå·²éƒ¨ç½² Agent | - |
| `--verify` | éªŒè¯æ¨¡å¼ | - |

---

## ğŸ“‹ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: éƒ¨ç½² L1 Agent

```bash
# 1. è¿è¡Œéƒ¨ç½²å‘½ä»¤
./deploy/bin/deploy-agent --mode l1 --name researcher --role "å•†ä¸šç ”ç©¶å‘˜"

# 2. è¾“å…¥ sudo å¯†ç 
ğŸ” éœ€è¦ sudo æƒé™æ¥é…ç½®ç³»ç»Ÿ
è¯·è¾“å…¥ sudo å¯†ç ï¼š********

# 3. ç­‰å¾…éƒ¨ç½²å®Œæˆ
[1/7] æ£€æŸ¥å‰ç½®æ¡ä»¶... âœ…
[2/7] åˆ†é…ç«¯å£... âœ…
[3/7] åˆ›å»º Profile ç›®å½•... âœ…
...
âœ… éƒ¨ç½²å®Œæˆï¼

# 4. éªŒè¯éƒ¨ç½²
./deploy/bin/deploy-agent --verify --name researcher
```

### ç¤ºä¾‹ 2: éƒ¨ç½² L2 Agent

```bash
# 1. è¿è¡Œéƒ¨ç½²å‘½ä»¤
./deploy/bin/deploy-agent --mode l2 --username wifey --role "å¤«äººåŠ©ç†"

# 2. è¾“å…¥ sudo å¯†ç 
ğŸ” éœ€è¦ sudo æƒé™æ¥é…ç½®ç³»ç»Ÿ
è¯·è¾“å…¥ sudo å¯†ç ï¼š********

# 3. è®¾ç½®ç”¨æˆ·å¯†ç 
è¯·è®¾ç½®ç”¨æˆ·å¯†ç ï¼š
New password: ********
Retype new password: ********

# 4. ç­‰å¾…éƒ¨ç½²å®Œæˆ
[1/8] æ£€æŸ¥å‰ç½®æ¡ä»¶... âœ…
[2/8] åˆ†é…ç«¯å£... âœ…
[3/8] åˆ›å»º macOS ç”¨æˆ·... âœ…
...
âœ… éƒ¨ç½²å®Œæˆï¼
```

### ç¤ºä¾‹ 3: é¢„æ¼”æ¨¡å¼

```bash
# æŸ¥çœ‹éƒ¨ç½²æ­¥éª¤ä½†ä¸å®é™…æ‰§è¡Œ
./deploy/bin/deploy-agent --mode l2 --username test --dry-run

# è¾“å‡º:
é¢„æ¼”éƒ¨ç½²æ­¥éª¤:
  1. æ£€æŸ¥å‰ç½®æ¡ä»¶
  2. åˆ†é…ç«¯å£ (é¢„è®¡ï¼š19004)
  3. åˆ†é… UID (é¢„è®¡ï¼š503)
  4. åˆ›å»ºç”¨æˆ·ï¼štest
  5. å®‰è£… NodeJS + OpenClaw
  6. é…ç½®ç¯å¢ƒ
  7. é…ç½® LaunchDaemon
  8. å¯åŠ¨ Gateway
  9. Telegram é…å¯¹

âœ… é¢„æ¼”å®Œæˆ
```

### ç¤ºä¾‹ 4: åˆ—å‡ºå·²éƒ¨ç½² Agent

```bash
./deploy/bin/deploy-agent --list

# è¾“å‡º:
ğŸ“Š å·²éƒ¨ç½²çš„ Agent

åç§°                 æ¨¡å¼     ç«¯å£     ç”¨æˆ·                 UID     
----------------------------------------------------------------------
claw                 L1       18789    -                    -       
sage                 L1       19001    -                    -       
shuaishuai           L2       19002    shuaishuai           502     
----------------------------------------------------------------------
æ€»è®¡ï¼š3 ä¸ª Agent
```

### ç¤ºä¾‹ 5: éªŒè¯éƒ¨ç½²

```bash
./deploy/bin/deploy-agent --verify --name shuaishuai

# è¾“å‡º:
å¼€å§‹éªŒè¯...

  âœ… è¿›ç¨‹æ£€æŸ¥ï¼šGateway è¿è¡Œä¸­
  âœ… ç«¯å£æ£€æŸ¥ï¼šç«¯å£ 19002 ç›‘å¬ä¸­
  âœ… WebSocket æ£€æŸ¥ï¼šWebSocket å¯è¿æ¥
  âš ï¸  å·¥ä½œæµç¨‹ï¼šè·³è¿‡ (éœ€æ‰‹åŠ¨éªŒè¯)

éªŒè¯ç»“æœï¼š3/4 é€šè¿‡
```

### ç¤ºä¾‹ 6: å›æ»šéƒ¨ç½²

```bash
# L1 å›æ»š
./deploy/bin/deploy-agent --rollback --name test --mode l1

# L2 å›æ»š
./deploy/bin/deploy-agent --rollback --name test --mode l2
```

---

## ğŸ”§ å¿«æ·è„šæœ¬

### L1 å¿«é€Ÿéƒ¨ç½²

```bash
# ä½¿ç”¨å¿«æ·è„šæœ¬
./scripts/deploy-l1-agent.sh --name researcher --role "å•†ä¸šç ”ç©¶å‘˜"
```

### L2 å¿«é€Ÿéƒ¨ç½²

```bash
# ä½¿ç”¨å¿«æ·è„šæœ¬
./scripts/deploy-l2-agent.sh --username wifey --role "å¤«äººåŠ©ç†"
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: sudo å¯†ç é”™è¯¯

```
âŒ éƒ¨ç½²å¤±è´¥ï¼šsudo: 1 incorrect password attempt
```

**è§£å†³**: ç¡®è®¤è¾“å…¥çš„æ˜¯å½“å‰ç”¨æˆ·çš„ sudo å¯†ç 

### Q2: ç«¯å£å·²è¢«å ç”¨

```
âŒ éƒ¨ç½²å¤±è´¥ï¼šPort 19003 is already in use
```

**è§£å†³**: ä½¿ç”¨ `--port` æŒ‡å®šå…¶ä»–ç«¯å£

### Q3: ç”¨æˆ·å·²å­˜åœ¨ (L2)

```
âŒ éƒ¨ç½²å¤±è´¥ï¼šç”¨æˆ·å·²å­˜åœ¨ï¼šwifey
```

**è§£å†³**: ä½¿ç”¨ä¸åŒçš„ç”¨æˆ·åï¼Œæˆ–åˆ é™¤ç°æœ‰ç”¨æˆ·

### Q4: å…±äº«å±‚ä¸å­˜åœ¨

```
âŒ éƒ¨ç½²å¤±è´¥ï¼šå…±äº«å±‚ä¸å­˜åœ¨ï¼š/Users/Shared/openclaw-common
```

**è§£å†³**: å…ˆåˆ›å»ºå…±äº«å±‚æˆ–æ£€æŸ¥è·¯å¾„

---

## ğŸ“Š éƒ¨ç½²åéªŒè¯

### æ‰‹åŠ¨éªŒè¯

```bash
# 1. æ£€æŸ¥è¿›ç¨‹
ps aux | grep openclaw | grep <ç«¯å£>

# 2. æ£€æŸ¥ç«¯å£
lsof -i :<ç«¯å£>

# 3. Telegram æµ‹è¯•
# å‘ Bot å‘é€ /start

# 4. å·¥ä½œæµç¨‹æµ‹è¯•
# å‘é€ï¼š"ä½ çš„å·¥ä½œæµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"
```

### è‡ªåŠ¨éªŒè¯

```bash
./deploy/bin/deploy-agent --verify --name <Agent åç§°>
```

---

## ğŸ“ ç›®å½•ç»“æ„

```
deploy/
â”œâ”€â”€ bin/
â”‚   â”œâ”€â”€ deploy-agent         # ä¸»éƒ¨ç½²è„šæœ¬ â­
â”‚   â”œâ”€â”€ verify-agent         # éªŒè¯è„šæœ¬
â”‚   â””â”€â”€ rollback-agent       # å›æ»šè„šæœ¬
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ config.py            # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ deploy_l1.py         # L1 éƒ¨ç½²å™¨
â”‚   â”œâ”€â”€ deploy_l2.py         # L2 éƒ¨ç½²å™¨
â”‚   â”œâ”€â”€ verify.py            # éªŒè¯å™¨
â”‚   â””â”€â”€ utils.py             # å·¥å…·å‡½æ•°
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ ports.yaml           # ç«¯å£åˆ†é…
â”‚   â””â”€â”€ defaults.yaml        # é»˜è®¤é…ç½®
â”œâ”€â”€ templates/               # Jinja2 æ¨¡æ¿
â””â”€â”€ logs/                    # éƒ¨ç½²æ—¥å¿—
```

---

## ğŸ¯ æœ€ä½³å®è·µ

1. **å…ˆç”¨ --dry-run é¢„æ¼”** - ç¡®è®¤æ­¥éª¤æ— è¯¯
2. **L2 éƒ¨ç½²å‰å¤‡ä»½** - é˜²æ­¢è¯¯æ“ä½œ
3. **éªŒè¯éƒ¨ç½²ç»“æœ** - ä½¿ç”¨ --verify
4. **è®°å½•éƒ¨ç½²æ—¥å¿—** - ä¾¿äºæ’æŸ¥é—®é¢˜
5. **å®šæœŸæ›´æ–°å·¥å…·** - è·å–æœ€æ–°åŠŸèƒ½

---

*æ–‡æ¡£è·¯å¾„ï¼š`~/Documents/claw-outputs/projects/agent-platform/docs/deploy-automation-guide.md`*
*æœ€åæ›´æ–°ï¼š2026-02-27 19:45*
